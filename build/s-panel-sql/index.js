import{useApi as e}from"@directus/extensions-sdk";import{resolveComponent as t,openBlock as n,createElementBlock as a,normalizeClass as s,createVNode as o,createSlots as i,renderList as r,withCtx as d,toDisplayString as l}from"vue";var c=[],p=[];!function(e,t){if(e&&"undefined"!=typeof document){var n,a=!0===t.prepend?"prepend":"append",s=!0===t.singleTag,o="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(s){var i=c.indexOf(o);-1===i&&(i=c.push(o)-1,p[i]={}),n=p[i]&&p[i][a]?p[i][a]:p[i][a]=r()}else n=r();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function r(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),s=0;s<n.length;s++)e.setAttribute(n[s],t.attributes[n[s]]);var i="prepend"===a?"afterbegin":"beforeend";return o.insertAdjacentElement(i,e),e}}("\n.sql-panel-container[data-v-2816c889] {\n\twidth: 100%;\n\theight: 100%;\n\toverflow-x: auto;\n\toverflow-y: auto;\n}\n.custom-link[data-v-2816c889] {\n\tcolor: #007bff;\n\ttext-decoration: none;\n}\n",{});const u={props:{id:String,showHeader:{type:Boolean,default:!1}},data:()=>({headers:[],items:[],loading:!0,sortConfig:{by:"",desc:"false"}}),created(){this.fetchData()},methods:{async fetchData(){const t=e(),{data:n}=await t(`sql-panel-api/${this.id}`);this.loading=!1,this.headers=n.headers.map((e=>({text:e.text,value:e.value}))),this.items=n.items},shouldRenderLink:e=>"string"==typeof e&&e.startsWith("http"),openLink(e){window.open(e,"_blank")},onSortUpdate(e){null!==e&&(this.loading=!0,this.items.sort(((t,n)=>{const a=t[e.by],s=n[e.by];return"string"==typeof a&&"string"==typeof s?e.desc?s.localeCompare(a):a.localeCompare(s):e.desc?s-a:a-s})),this.loading=!1)}}},h=["onClick"];var f={id:"sql-panel-s",name:"SQL panel S",icon:"box",description:"Show result of a stored SQL query as a table",component:((e,t)=>{const n=e.__vccOpts||e;for(const[e,a]of t)n[e]=a;return n})(u,[["render",function(e,c,p,u,f,m){const g=t("v-table");return n(),a("div",{class:s(["sql-panel-container",{"has-header":p.showHeader}])},[o(g,{class:"table",showResize:!0,headers:f.headers,"onUpdate:headers":c[0]||(c[0]=e=>f.headers=e),items:f.items,loading:f.loading,"onUpdate:sort":[m.onSortUpdate,c[1]||(c[1]=e=>f.sortConfig=e)],sort:f.sortConfig},i({_:2},[r(f.headers,((e,t)=>({name:`item.${e.value}`,fn:d((({item:s})=>[m.shouldRenderLink(s[e.value])?(n(),a("div",{key:t+"link",onClick:t=>m.openLink(s[e.value]),class:"custom-link"},l(s[e.value]),9,h)):(n(),a("div",{key:t},l(s[e.value]),1))]))})))]),1032,["headers","items","loading","onUpdate:sort","sort"])],2)}],["__scopeId","data-v-2816c889"],["__file","panel.vue"]]),options:[{field:"sql",name:"SQL query",type:"string",meta:{interface:"input-multiline",width:"full"}},{field:"columnWidth",name:"Coma separated list of column widths",type:"string",meta:{interface:"input",width:"full"}}],minWidth:12,minHeight:8};export{f as default};
